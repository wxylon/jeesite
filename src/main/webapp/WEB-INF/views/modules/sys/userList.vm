#set($title='用户管理')
<script type="text/javascript">
	$(document).ready(function() {
		$("#btnExport").click(function(){
			top.$.jBox.confirm("确认要导出用户数据吗？","系统提示",function(v,h,f){
				if(v=="ok"){
					$("#searchForm").attr("action","${ctx}/sys/user/export");
					$("#searchForm").submit();
				}
			},{buttonsFocus:1});
			top.$('.jbox-body .jbox-icon').css('top','55px');
		});
		$("#btnImport").click(function(){
			$.jBox($("#importBox").html(), {title:"导入数据", buttons:{"关闭":true},
				bottomText:"导入文件不能超过5M，仅允许导入“xls”或“xlsx”格式文件！"});
		});
	});
	function page(n,s){
		if(n) $("#pageNo").val(n);
		if(s) $("#pageSize").val(s);
		$("#searchForm").attr("action","${ctx}/sys/user/list");
		$("#searchForm").submit();
		return false;
	}
</script>
<div id="importBox" class="hide">
	<form id="importForm" action="${ctx}/sys/user/import" method="post" enctype="multipart/form-data"
		class="form-search" style="padding-left:20px;text-align:center;" onsubmit="loading('正在导入，请稍等...');"><br/>
		<input id="uploadFile" name="file" type="file" style="width:330px"/><br/><br/>　　
		<input id="btnImportSubmit" class="btn btn-primary" type="submit" value="   导    入   "/>
		<a href="${ctx}/sys/user/import/template">下载模板</a>
	</form>
</div>
<ul class="nav nav-tabs">
	<li class="active"><a href="${ctx}/sys/user/list">用户列表</a></li>
	#if($shiro.hasPermission('sys:user:edit'))<li><a href="${ctx}/sys/user/form">用户添加</a></li>#end
</ul>
<form id="searchForm" action="${ctx}/sys/user/list" method="post" class="breadcrumb form-search ">
	<input id="pageNo" name="pageNo" type="hidden" value="${page.pageNo}"/>
	<input id="pageSize" name="pageSize" type="hidden" value="${page.pageSize}"/>
	#sysTableSort('orderBy', 'orderBy', $!{page.orderBy}, 'page();')
	<ul class="ul-form">
		<li><label>归属公司：</label>
            #sysTreeSelect('company', 'company.id',$!{user.company.id}, 'company.name', $!{user.company.name}, '公司', '/sys/office/treeData?type=1', false, '', false, false, false, '', false, true, false, 'input-small', '', false, false, false, '')
		</li>
		<li><label>登录名：</label>
            <input id="loginName" name="loginName" class="input-medium" type="text" value="$!{loginName}" maxlength="50"/>
		</li>
		<li class="clearfix"></li>
		<li><label>归属部门：</label>
			#sysTreeSelect('office', 'office.id',$!{user.office.id}, 'office.name', $!{user.office.name}, '部门', '/sys/office/treeData?type=2', false, '', false, false, true, '', false, true, false, 'input-small', '', false, false, false, '')
		</li>
		<li><label>姓&nbsp;&nbsp;&nbsp;名：</label>
            <input id="name" name="name" class="input-medium" type="text" value="$!{name}" maxlength="50"/>
		</li>
		<li class="btns"><input id="btnSubmit" class="btn btn-primary" type="submit" value="查询" onclick="return page();"/>
			<input id="btnExport" class="btn btn-primary" type="button" value="导出"/>
			<input id="btnImport" class="btn btn-primary" type="button" value="导入"/></li>
		<li class="clearfix"></li>
	</ul>
</form>
#sysMessage($!{message})
<table id="contentTable" class="table table-striped table-bordered table-condensed">
	<thead><tr><th>归属公司</th><th>归属部门</th><th class="sort-column login_name">登录名</th><th class="sort-column name">姓名</th><th>电话</th><th>手机</th>#if($shiro.hasPermission('sys:user:edit'))<th>操作</th>#end</tr></thead>
	<tbody>
		#foreach($user in ${page.list})
		<tr>
			<td>$!{user.company.name}</td>
			<td>$!{user.office.name}</td>
			<td><a href="${ctx}/sys/user/form?id=${user.id}">$!{user.loginName}</a></td>
			<td>$!{user.name}</td>
			<td>$!{user.phone}</td>
			<td>$!{user.mobile}</td>
			#if($shiro.hasPermission('sys:user:edit'))
				<td>
					<a href="${ctx}/sys/user/form?id=$!{user.id}">修改</a>
					<a href="${ctx}/sys/user/delete?id=$!{user.id}" onclick="return confirmx('确认要删除该用户吗？', this.href)">删除</a>
				</td>
			#end
		</tr>
		#end
	</tbody>
</table>
<div class="pagination">${page}</div>