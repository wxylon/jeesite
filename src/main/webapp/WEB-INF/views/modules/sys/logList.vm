#set($title='日志管理')
<script type="text/javascript">
	function page(n,s){
		$("#pageNo").val(n);
		$("#pageSize").val(s);
		$("#searchForm").submit();
		return false;
	}
</script>
<ul class="nav nav-tabs">
	<li class="active"><a href="javascript:void(0);">日志列表</a></li>
</ul>
<form id="searchForm" class="breadcrumb form-search" action="${ctx}/sys/log/" method="post">
		<input id="pageNo" name="pageNo" type="hidden" value="$!{page.pageNo}"/>
		<input id="pageSize" name="pageSize" type="hidden" value="$!{page.pageSize}"/>
		<div>
			<label>操作菜单：</label><input id="title" name="title" type="text" maxlength="50" class="input-mini" value="$!{log.title}"/>
			<label>用户ID：</label><input id="createBy.id" name="createBy.id" type="text" maxlength="50" class="input-mini" value="$!{log.createBy.id}"/>
			<label>URI：</label><input id="requestUri" name="requestUri" type="text" maxlength="50" class="input-mini" value="$!{log.requestUri}"/>
		</div>
		<div style="margin-top:8px;">
			<label>日期范围：&nbsp;</label>
			<input id="beginDate" name="beginDate" type="text" readonly="readonly" maxlength="20" class="input-mini Wdate"
				   value="$dateUtils.formatDate(${log.beginDate})" onclick="WdatePicker({dateFmt:'yyyy-MM-dd',isShowClear:false});"/>
			<label>&nbsp;--&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</label>
			<input id="endDate" name="endDate" type="text" readonly="readonly" maxlength="20" class="input-mini Wdate"
				   value="$dateUtils.formatDate(${log.beginDate})" onclick="WdatePicker({dateFmt:'yyyy-MM-dd',isShowClear:false});"/>&nbsp;&nbsp;&nbsp;
			<label for="exception"><input id="exception" name="exception" type="checkbox" #if(${log.exception} == '1') checked #end value="1"/>只查询异常信息</label>&nbsp;&nbsp;&nbsp;
			<input id="btnSubmit" class="btn btn-primary" type="submit" value="查询"/>&nbsp;&nbsp;
		</div>
	</form>
	#sysMessage($!{message})
	<table id="contentTable" class="table table-striped table-bordered table-condensed">
		<thead><tr><th>操作菜单</th><th>操作用户</th><th>所在公司</th><th>所在部门</th><th>URI</th><th>提交方式</th><th>操作者IP</th><th>操作时间</th></thead>
		<tbody>
		#foreach($log in ${page.list})
			<tr>
				<td>$!{log.title}</td>
				<td>$!{log.createBy.name}</td>
				<td>$!{log.createBy.company.name}</td>
				<td>$!{log.createBy.office.name}</td>
				<td><strong>$!{log.requestUri}</strong></td>
				<td>$!{log.method}</td>
				<td>$!{log.remoteAddr}</td>
				<td>$!dateUtils.formatDateTime(${log.createDate})</td>
			</tr>
			#if(!${log.exception})
				<tr>
					<td colspan="8" style="word-wrap:break-word;word-break:break-all;">
	## 					用户代理: ${log.userAgent}<br/>
	## 					提交参数: ${fns:escapeHtml(log.params)} <br/>
						异常信息: <br/>
						$$stringUtils.replace($stringUtils.replace($stringUtils.escapeHtml($!{log.exception}), strEnter, '<br/>'), strTab, '&nbsp; &nbsp; ')</td>
				</tr>
			#end
		#end
		</tbody>
	</table>
	<div class="pagination">${page}</div>
</body>
</html>